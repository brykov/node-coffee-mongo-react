(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Generated by CoffeeScript 1.10.0
(function() {
  var templates,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  templates = {};

  templates['App'] = require('./templates/app.jsx');

  templates['TypeBox'] = require('./templates/type_box.jsx');

  templates['FancyInput'] = require('./templates/fancy_input.jsx');

  window.FancyInput = (function(superClass) {
    extend(FancyInput, superClass);

    function FancyInput() {
      this.render = bind(this.render, this);
      this.changeHandler = bind(this.changeHandler, this);
      this.componentWillMount = bind(this.componentWillMount, this);
      return FancyInput.__super__.constructor.apply(this, arguments);
    }

    FancyInput.prototype.componentWillMount = function() {
      return this.setState({
        data: this.props.provider.state.data
      });
    };

    FancyInput.prototype.changeHandler = function(e) {
      var data;
      data = this.state.data;
      data[this.props.name] = e.target.value;
      return this.setState({
        data: data
      });
    };

    FancyInput.prototype.render = function() {
      return templates['FancyInput'].bind(this)();
    };

    return FancyInput;

  })(React.Component);

  window.TypeBox = (function(superClass) {
    extend(TypeBox, superClass);

    function TypeBox() {
      this.render = bind(this.render, this);
      this.componentDidMount = bind(this.componentDidMount, this);
      this.componentWillMount = bind(this.componentWillMount, this);
      this.save = bind(this.save, this);
      this.cancelEditMode = bind(this.cancelEditMode, this);
      this.editMode = bind(this.editMode, this);
      return TypeBox.__super__.constructor.apply(this, arguments);
    }

    TypeBox.prototype.editMode = function() {
      return this.setState({
        editMode: true
      });
    };

    TypeBox.prototype.cancelEditMode = function() {
      if (this.state.data._new) {
        return this.props.app.delNodeType(this.state.data);
      }
      return this.setState({
        editMode: false,
        data: _.clone(this.data_copy)
      });
    };

    TypeBox.prototype.save = function() {
      this.props.app.save();
      this.data_copy = _.clone(this.state.data);
      return this.setState({
        editMode: false,
        _new: false
      });
    };

    TypeBox.prototype.componentWillMount = function() {
      return this.setState({
        editMode: !!this.props.data._new,
        data: this.props.data
      });
    };

    TypeBox.prototype.componentDidMount = function() {
      return this.data_copy = _.clone(this.props.data);
    };

    TypeBox.prototype.render = function() {
      return templates['TypeBox'].bind(this)();
    };

    return TypeBox;

  })(React.Component);

  window.App = (function(superClass) {
    extend(App, superClass);

    function App() {
      this.render = bind(this.render, this);
      this.save = bind(this.save, this);
      this.componentDidMount = bind(this.componentDidMount, this);
      this.loadNodeTypes = bind(this.loadNodeTypes, this);
      this.delNodeType = bind(this.delNodeType, this);
      this.newNodeType = bind(this.newNodeType, this);
      this.componentWillMount = bind(this.componentWillMount, this);
      return App.__super__.constructor.apply(this, arguments);
    }

    App.prototype.componentWillMount = function() {
      return this.setState({
        node_types: []
      });
    };

    App.prototype.newNodeType = function() {
      var list;
      list = this.state.node_types;
      list.push({
        _id: (new Date).valueOf(),
        _new: true,
        name: '',
        title: ''
      });
      this.setState({
        node_types: list
      });
    };

    App.prototype.delNodeType = function(el) {
      var list;
      list = this.state.node_types;
      list.splice(list.indexOf(el), 1);
      this.setState({
        node_types: list
      });
    };

    App.prototype.loadNodeTypes = function() {
      qwest.get('/node_types').then((function(_this) {
        return function(xhr, response) {
          _this.setState({
            node_types: response['node_types']
          });
        };
      })(this));
    };

    App.prototype.componentDidMount = function() {
      this.loadNodeTypes();
    };

    App.prototype.save = function() {
      qwest.post('/node_types', {
        node_types: this.state.node_types
      }, {
        dataType: 'json'
      }).then((function(_this) {
        return function(xhr, response) {
          if (response.success === 'OK') {
            _this.loadNodeTypes();
          }
        };
      })(this))["catch"](function(e, xhr, response) {});
    };

    App.prototype.render = function() {
      return templates['App'].bind(this)();
    };

    return App;

  })(React.Component);

  ReactDOM.render(React.createElement(App), document.getElementById('react-app'));

}).call(this);


},{"./templates/app.jsx":2,"./templates/fancy_input.jsx":3,"./templates/type_box.jsx":4}],2:[function(require,module,exports){
module.exports = function () {
  var type_box_list = this.state.node_types.map((type) =>
      React.createElement(TypeBox, {data: type, app: this, key: type._id})
  );

  return (
    React.createElement("div", {className: "app"}, 
      React.createElement("button", {onClick: this.newNodeType}, "ADD"), 
      type_box_list
    )
  );
};

},{}],3:[function(require,module,exports){
module.exports = function () {
  return(
    React.createElement("input", {type: "text", defaultValue: this.state.data[this.props.name], onChange: this.changeHandler})
  );
};

},{}],4:[function(require,module,exports){
module.exports = function () {
  var _view =
    React.createElement("div", {className: "type-box"}, 
      this.state.data.name, 
      "/", 
      this.state.data.title, 
      React.createElement("button", {onClick: this.editMode}, "EDIT")
    );
  var _edit =
    React.createElement("div", {className: "type-box"}, 
      React.createElement("div", null, "id: ", React.createElement(FancyInput, {provider: this, name: "name"})), 
      React.createElement("div", null, "title: ", React.createElement(FancyInput, {provider: this, name: "title"})), 
      React.createElement("button", {onClick: this.save}, "SAVE"), 
      React.createElement("button", {onClick: this.cancelEditMode}, "CANCEL")
    );
  return this.state.editMode ? _edit : _view;
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvamF2YXNjcmlwdHMvbWFpbi5jb2ZmZWUiLCIvVXNlcnMvaXZhbi9wcm9qZWN0cy9vd24vbm9kZS1jb2ZmZWUtbW9uZ28tcmVhY3QvcHVibGljL2phdmFzY3JpcHRzL3RlbXBsYXRlcy9hcHAuanN4IiwiL1VzZXJzL2l2YW4vcHJvamVjdHMvb3duL25vZGUtY29mZmVlLW1vbmdvLXJlYWN0L3B1YmxpYy9qYXZhc2NyaXB0cy90ZW1wbGF0ZXMvZmFuY3lfaW5wdXQuanN4IiwiL1VzZXJzL2l2YW4vcHJvamVjdHMvb3duL25vZGUtY29mZmVlLW1vbmdvLXJlYWN0L3B1YmxpYy9qYXZhc2NyaXB0cy90ZW1wbGF0ZXMvdHlwZV9ib3guanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBO0FBQUEsTUFBQSxTQUFBO0lBQUE7Ozs7RUFBQSxTQUFBLEdBQVk7O0VBQ1osU0FBVSxDQUFBLEtBQUEsQ0FBVixHQUFtQixPQUFBLENBQVEscUJBQVI7O0VBQ25CLFNBQVUsQ0FBQSxTQUFBLENBQVYsR0FBdUIsT0FBQSxDQUFRLDBCQUFSOztFQUN2QixTQUFVLENBQUEsWUFBQSxDQUFWLEdBQTBCLE9BQUEsQ0FBUSw2QkFBUjs7RUFFcEIsTUFBTSxDQUFDOzs7Ozs7Ozs7O3lCQUNYLGtCQUFBLEdBQW9CLFNBQUE7YUFDbEIsSUFBQyxDQUFBLFFBQUQsQ0FBVTtRQUFFLElBQUEsRUFBTSxJQUFDLENBQUEsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBOUI7T0FBVjtJQURrQjs7eUJBRXBCLGFBQUEsR0FBZSxTQUFDLENBQUQ7QUFDYixVQUFBO01BQUEsSUFBQSxHQUFPLElBQUMsQ0FBQSxLQUFLLENBQUM7TUFDZCxJQUFLLENBQUEsSUFBQyxDQUFBLEtBQUssQ0FBQyxJQUFQLENBQUwsR0FBb0IsQ0FBQyxDQUFDLE1BQU0sQ0FBQzthQUM3QixJQUFDLENBQUEs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LENBQUEsRUFBQTtNQUN4QixvQkFBQSxLQUFJLEVBQUEsSUFBQyxFQUFBLE1BQUEsRUFBSSxvQkFBQyxVQUFVLEVBQUEsQ0FBQSxDQUFDLFFBQUEsRUFBUSxDQUFFLElBQUksRUFBQyxDQUFDLElBQUEsRUFBSSxDQUFDLE1BQU0sQ0FBRSxDQUFNLENBQUEsRUFBQTtNQUN4RCxvQkFBQSxLQUFJLEVBQUEsSUFBQyxFQUFBLFNBQUEsRUFBTyxvQkFBQyxVQUFVLEVBQUEsQ0FBQSxDQUFDLFFBQUEsRUFBUSxDQUFFLElBQUksRUFBQyxDQUFDLElBQUEsRUFBSSxDQUFDLE9BQU8sQ0FBRSxDQUFNLENBQUEsRUFBQTtNQUM1RCxvQkFBQSxRQUFPLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFFLElBQUksQ0FBQyxJQUFNLENBQUEsRUFBQSxNQUFhLENBQUEsRUFBQTtNQUN6QyxvQkFBQSxRQUFPLEVBQUEsQ0FBQSxDQUFDLE9BQUEsRUFBTyxDQUFFLElBQUksQ0FBQyxjQUFnQixDQUFBLEVBQUEsUUFBZSxDQUFBO0lBQ2pELENBQUEsQ0FBQztFQUNULE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSyxHQUFHLEtBQUssQ0FBQztDQUM1QyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ0ZW1wbGF0ZXMgPSB7fVxudGVtcGxhdGVzWydBcHAnXSA9IHJlcXVpcmUgJy4vdGVtcGxhdGVzL2FwcC5qc3gnXG50ZW1wbGF0ZXNbJ1R5cGVCb3gnXSA9IHJlcXVpcmUgJy4vdGVtcGxhdGVzL3R5cGVfYm94LmpzeCdcbnRlbXBsYXRlc1snRmFuY3lJbnB1dCddID0gcmVxdWlyZSAnLi90ZW1wbGF0ZXMvZmFuY3lfaW5wdXQuanN4J1xuXG5jbGFzcyB3aW5kb3cuRmFuY3lJbnB1dCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudFxuICBjb21wb25lbnRXaWxsTW91bnQ6ID0+XG4gICAgQHNldFN0YXRlIHsgZGF0YTogQHByb3BzLnByb3ZpZGVyLnN0YXRlLmRhdGEgfVxuICBjaGFuZ2VIYW5kbGVyOiAoZSkgPT5cbiAgICBkYXRhID0gQHN0YXRlLmRhdGFcbiAgICBkYXRhW0Bwcm9wcy5uYW1lXSA9IGUudGFyZ2V0LnZhbHVlXG4gICAgQHNldFN0YXRlIGRhdGE6IGRhdGFcbiAgcmVuZGVyOiA9PlxuICAgIHRlbXBsYXRlc1snRmFuY3lJbnB1dCddLmJpbmQoQCkoKVxuXG5cbmNsYXNzIHdpbmRvdy5UeXBlQm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50XG4gIGVkaXRNb2RlOiA9PlxuICAgIEBzZXRTdGF0ZSBlZGl0TW9kZTogdHJ1ZVxuICBjYW5jZWxFZGl0TW9kZTogPT5cbiAgICBpZiBAc3RhdGUuZGF0YS5fbmV3XG4gICAgICByZXR1cm4gQHByb3BzLmFwcC5kZWxOb2RlVHlwZShAc3RhdGUuZGF0YSlcbiAgICBAc2V0U3RhdGVcbiAgICAgIGVkaXRNb2RlOiBmYWxzZVxuICAgICAgZGF0YTogXy5jbG9uZShAZGF0YV9jb3B5KVxuICBzYXZlOiA9PlxuICAgIEBwcm9wcy5hcHAuc2F2ZSgpXG4gICAgQGRhdGFfY29weSA9IF8uY2xvbmUoQHN0YXRlLmRhdGEpXG4gICAgQHNldFN0YXRlXG4gICAgICBlZGl0TW9kZTogZmFsc2VcbiAgICAgIF9uZXc6IGZhbHNlXG4gIGNvbXBvbmVudFdpbGxNb3VudDogPT5cbiAgICBAc2V0U3RhdGUge1xuICAgICAgZWRpdE1vZGU6ICEhQHByb3BzLmRhdGEuX25ld1xuICAgICAgZGF0YTogQHByb3BzLmRhdGFcbiAgICB9XG4gIGNvbXBvbmVudERpZE1vdW50OiA9PlxuICAgIEBkYXRhX2NvcHkgPSBfLmNsb25lKEBwcm9wcy5kYXRhKVxuICByZW5kZXI6ID0+XG4gICAgdGVtcGxhdGVzWydUeXBlQm94J10uYmluZChAKSgpXG5cblxuY2xhc3Mgd2luZG93LkFwcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudFxuICBjb21wb25lbnRXaWxsTW91bnQ6ID0+XG4gICAgQHNldFN0YXRlIHsgbm9kZV90eXBlczogW10gfVxuICBuZXdOb2RlVHlwZTogPT5cbiAgICBsaXN0ID0gQHN0YXRlLm5vZGVfdHlwZXNcbiAgICBsaXN0LnB1c2hcbiAgICAgIF9pZDogKG5ldyBEYXRlKS52YWx1ZU9mKClcbiAgICAgIF9uZXc6IHRydWVcbiAgICAgIG5hbWU6ICcnXG4gICAgICB0aXRsZTogJydcbiAgICBAc2V0U3RhdGUgbm9kZV90eXBlczogbGlzdFxuICAgIHJldHVyblxuICBkZWxOb2RlVHlwZTogKGVsKSA9PlxuICAgIGxpc3QgPSBAc3RhdGUubm9kZV90eXBlc1xuICAgIGxpc3Quc3BsaWNlIGxpc3QuaW5kZXhPZihlbCksIDFcbiAgICBAc2V0U3RhdGUgbm9kZV90eXBlczogbGlzdFxuICAgIHJldHVyblxuICBsb2FkTm9kZVR5cGVzOiA9PlxuICAgIHF3ZXN0LmdldCgnL25vZGVfdHlwZXMnKS50aGVuICh4aHIsIHJlc3BvbnNlKSA9PlxuICAgICAgQHNldFN0YXRlIG5vZGVfdHlwZXM6IHJlc3BvbnNlWydub2RlX3R5cGVzJ11cbiAgICAgICNjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICByZXR1cm5cbiAgICByZXR1cm5cbiAgY29tcG9uZW50RGlkTW91bnQ6ID0+XG4gICAgQGxvYWROb2RlVHlwZXMoKVxuICAgIHJldHVyblxuICBzYXZlOiA9PlxuICAgIHF3ZXN0LnBvc3QoJy9ub2RlX3R5cGVzJywge25vZGVfdHlwZXM6IEBzdGF0ZS5ub2RlX3R5cGVzfSwgZGF0YVR5cGU6ICdqc29uJykudGhlbigoeGhyLCByZXNwb25zZSkgPT5cbiNjb25zb2xlLmxvZyhbeGhyLCByZXNwb25zZV0pO1xuICAgICAgaWYgcmVzcG9uc2Uuc3VjY2VzcyA9PSAnT0snXG4gICAgICAgIEBsb2FkTm9kZVR5cGVzKClcbiAgICAgIHJldHVyblxuICAgICkuY2F0Y2ggKGUsIHhociwgcmVzcG9uc2UpIC0+XG4jY29uc29sZS5sb2coW2UsIHhociwgcmVzcG9uc2VdKTtcbiAgICAgIHJldHVyblxuICAgIHJldHVyblxuICByZW5kZXI6ID0+XG4gICAgdGVtcGxhdGVzWydBcHAnXS5iaW5kKEApKClcblxuXG5cblJlYWN0RE9NLnJlbmRlciBSZWFjdC5jcmVhdGVFbGVtZW50KEFwcCksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWFjdC1hcHAnKVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0eXBlX2JveF9saXN0ID0gdGhpcy5zdGF0ZS5ub2RlX3R5cGVzLm1hcCgodHlwZSkgPT5cbiAgICAgIDxUeXBlQm94IGRhdGE9e3R5cGV9IGFwcD17dGhpc30ga2V5PXt0eXBlLl9pZH0vPlxuICApO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJhcHBcIj5cbiAgICAgIDxidXR0b24gb25DbGljaz17dGhpcy5uZXdOb2RlVHlwZX0+QUREPC9idXR0b24+XG4gICAgICB7dHlwZV9ib3hfbGlzdH1cbiAgICA8L2Rpdj5cbiAgKTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuKFxuICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGRlZmF1bHRWYWx1ZT17dGhpcy5zdGF0ZS5kYXRhW3RoaXMucHJvcHMubmFtZV19IG9uQ2hhbmdlPXt0aGlzLmNoYW5nZUhhbmRsZXJ9Lz5cbiAgKTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBfdmlldyA9XG4gICAgPGRpdiBjbGFzc05hbWU9XCJ0eXBlLWJveFwiPlxuICAgICAge3RoaXMuc3RhdGUuZGF0YS5uYW1lfVxuICAgICAgL1xuICAgICAge3RoaXMuc3RhdGUuZGF0YS50aXRsZX1cbiAgICAgIDxidXR0b24gb25DbGljaz17dGhpcy5lZGl0TW9kZX0+RURJVDwvYnV0dG9uPlxuICAgIDwvZGl2PjtcbiAgdmFyIF9lZGl0ID1cbiAgICA8ZGl2IGNsYXNzTmFtZT1cInR5cGUtYm94XCI+XG4gICAgICA8ZGl2PmlkOiA8RmFuY3lJbnB1dCBwcm92aWRlcj17dGhpc30gbmFtZT1cIm5hbWVcIi8+PC9kaXY+XG4gICAgICA8ZGl2PnRpdGxlOiA8RmFuY3lJbnB1dCBwcm92aWRlcj17dGhpc30gbmFtZT1cInRpdGxlXCIvPjwvZGl2PlxuICAgICAgPGJ1dHRvbiBvbkNsaWNrPXt0aGlzLnNhdmV9PlNBVkU8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gb25DbGljaz17dGhpcy5jYW5jZWxFZGl0TW9kZX0+Q0FOQ0VMPC9idXR0b24+XG4gICAgPC9kaXY+O1xuICByZXR1cm4gdGhpcy5zdGF0ZS5lZGl0TW9kZSA/IF9lZGl0IDogX3ZpZXc7XG59OyJdfQ==
